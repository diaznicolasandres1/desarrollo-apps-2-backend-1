# üéØ An√°lisis de Casos de Uso - Lugares Culturales

## üìã √çndice
- [Descripci√≥n General](#descripci√≥n-general)
- [Actores del Sistema](#actores-del-sistema)
- [Casos de Uso Principales](#casos-de-uso-principales)
- [Casos de Uso Adicionales](#casos-de-uso-adicionales)
- [Arquitectura de M√≥dulos](#arquitectura-de-m√≥dulos)
- [Endpoints Sugeridos](#endpoints-sugeridos)
- [Flujos de Trabajo](#flujos-de-trabajo)
- [Consideraciones T√©cnicas](#consideraciones-t√©cnicas)

---

## üéØ Descripci√≥n General

### **Prop√≥sito del Sistema**
Aplicaci√≥n web para la gesti√≥n integral de lugares culturales, eventos y venta de entradas. El sistema permite a administradores y supervisores gestionar el contenido cultural, mientras que los usuarios pueden explorar lugares, eventos y realizar compras de entradas.

### **Objetivos Principales**
- Facilitar la gesti√≥n de lugares culturales
- Permitir la creaci√≥n y gesti√≥n de eventos
- Proporcionar un sistema de venta de entradas
- Ofrecer herramientas de b√∫squeda y filtrado
- Generar reportes y analytics

---

## üë• Actores del Sistema

### **1. Administrador**
- **Descripci√≥n**: Usuario con acceso completo al sistema
- **Responsabilidades**:
  - Gesti√≥n completa de lugares culturales
  - Gesti√≥n de eventos y entradas
  - Administraci√≥n de usuarios y roles
  - Generaci√≥n de reportes
  - Configuraci√≥n del sistema

### **2. Supervisor**
- **Descripci√≥n**: Usuario con permisos limitados de gesti√≥n
- **Responsabilidades**:
  - Crear y modificar lugares culturales
  - Gestionar eventos
  - Validar entradas
  - Ver reportes b√°sicos

### **3. Usuario Registrado**
- **Descripci√≥n**: Usuario final del sistema
- **Responsabilidades**:
  - Explorar lugares y eventos
  - Comprar entradas
  - Ver historial de compras
  - Recibir notificaciones

### **4. Sistema**
- **Descripci√≥n**: Procesos autom√°ticos
- **Responsabilidades**:
  - Env√≠o de notificaciones
  - Validaciones autom√°ticas
  - Procesamiento de datos

---

## üèõÔ∏è Casos de Uso Principales

### **1. Gesti√≥n de Lugares Culturales**

#### **1.1 Dar de Alta un Lugar**
- **ID**: UC-001
- **Actor**: Administrador/Supervisor
- **Descripci√≥n**: Crear un nuevo lugar cultural en el sistema
- **Precondiciones**: Usuario autenticado con permisos adecuados
- **Flujo Principal**:
  1. Usuario accede al formulario de creaci√≥n
  2. Completa los datos del lugar (nombre, categor√≠a, caracter√≠sticas, horarios, contacto, imagen)
  3. Sistema valida los datos ingresados
  4. Sistema crea el lugar y asigna ID √∫nico
  5. Sistema confirma la creaci√≥n
- **Postcondiciones**: Lugar creado y disponible en el sistema
- **Validaciones**:
  - Nombre √∫nico en el sistema
  - Coordenadas geogr√°ficas v√°lidas
  - Email v√°lido
  - Categor√≠a v√°lida
  - Horarios coherentes

#### **1.2 Modificar un Lugar**
- **ID**: UC-002
- **Actor**: Administrador/Supervisor
- **Descripci√≥n**: Actualizar informaci√≥n de un lugar existente
- **Precondiciones**: Lugar existente en el sistema
- **Flujo Principal**:
  1. Usuario selecciona lugar a modificar
  2. Sistema carga datos actuales
  3. Usuario modifica los campos deseados
  4. Sistema valida cambios
  5. Sistema actualiza informaci√≥n
- **Postcondiciones**: Lugar actualizado con nueva informaci√≥n
- **Validaciones**: Mismas que en alta

#### **1.3 Desactivar/Activar Lugar**
- **ID**: UC-003
- **Actor**: Administrador
- **Descripci√≥n**: Cambiar estado activo/inactivo de un lugar
- **Precondiciones**: Lugar existente
- **Flujo Principal**:
  1. Usuario selecciona lugar
  2. Cambia estado a activo/inactivo
  3. Sistema actualiza estado
- **Postcondiciones**: Lugar con nuevo estado

### **2. Gesti√≥n de Eventos**

#### **2.1 Crear Evento para un Lugar**
- **ID**: UC-004
- **Actor**: Administrador/Supervisor
- **Descripci√≥n**: Crear un nuevo evento en un lugar espec√≠fico
- **Precondiciones**: Lugar existente y activo
- **Flujo Principal**:
  1. Usuario selecciona lugar
  2. Completa datos del evento (nombre, descripci√≥n, fecha, horario, tipos de entrada)
  3. Sistema valida datos
  4. Sistema crea evento
- **Postcondiciones**: Evento creado y disponible
- **Validaciones**:
  - Lugar debe existir y estar activo
  - Fecha futura
  - Tipos de entrada v√°lidos
  - Horarios coherentes

#### **2.2 Modificar Evento**
- **ID**: UC-005
- **Actor**: Administrador/Supervisor
- **Descripci√≥n**: Actualizar informaci√≥n de un evento
- **Precondiciones**: Evento existente
- **Flujo Principal**:
  1. Usuario selecciona evento
  2. Modifica datos permitidos
  3. Sistema valida cambios
  4. Sistema actualiza evento
- **Postcondiciones**: Evento actualizado
- **Validaciones**: No permitir modificar si ya hay entradas vendidas

#### **2.3 Cancelar Evento**
- **ID**: UC-006
- **Actor**: Administrador/Supervisor
- **Descripci√≥n**: Cancelar un evento y procesar reembolsos
- **Precondiciones**: Evento existente
- **Flujo Principal**:
  1. Usuario selecciona evento a cancelar
  2. Ingresa motivo de cancelaci√≥n
  3. Sistema cancela evento
  4. Sistema procesa reembolsos autom√°ticos
  5. Sistema notifica a usuarios afectados
- **Postcondiciones**: Evento cancelado, entradas reembolsadas

### **3. Gesti√≥n de Entradas**

#### **3.1 Comprar Entradas**
- **ID**: UC-007
- **Actor**: Usuario registrado
- **Descripci√≥n**: Comprar una o m√°s entradas para un evento
- **Precondiciones**: Usuario autenticado, evento activo
- **Flujo Principal**:
  1. Usuario selecciona evento
  2. Elige tipos y cantidades de entradas
  3. Sistema verifica disponibilidad
  4. Usuario confirma compra
  5. Sistema crea entradas individuales
  6. Sistema confirma compra
- **Postcondiciones**: Entradas creadas y asignadas al usuario
- **Validaciones**:
  - Evento activo y con disponibilidad
  - Usuario autenticado
  - Stock disponible
  - Tipos de entrada v√°lidos

#### **3.2 Consumir Entradas**
- **ID**: UC-008
- **Actor**: Supervisor/Administrador
- **Descripci√≥n**: Validar y marcar entrada como usada
- **Precondiciones**: Entrada v√°lida y activa
- **Flujo Principal**:
  1. Usuario presenta entrada (QR, c√≥digo, etc.)
  2. Sistema valida entrada
  3. Sistema marca como usada
  4. Sistema registra fecha y hora de uso
- **Postcondiciones**: Entrada marcada como usada
- **Validaciones**:
  - Entrada v√°lida y activa
  - Fecha del evento correcta
  - No usada previamente

#### **3.3 Reembolsar Entradas**
- **ID**: UC-009
- **Actor**: Administrador/Supervisor
- **Descripci√≥n**: Procesar reembolso de entradas
- **Precondiciones**: Entrada existente
- **Flujo Principal**:
  1. Usuario solicita reembolso
  2. Administrador eval√∫a solicitud
  3. Sistema procesa reembolso
  4. Sistema marca entrada como reembolsada
- **Postcondiciones**: Entrada reembolsada

---

## üîç Casos de Uso Adicionales

### **4. Consultas y B√∫squedas**

#### **4.1 Buscar Lugares por Categor√≠a**
- **ID**: UC-010
- **Actor**: Usuario
- **Descripci√≥n**: Filtrar lugares por tipo (Museo, Teatro, etc.)
- **Flujo Principal**:
  1. Usuario selecciona categor√≠a
  2. Sistema filtra lugares
  3. Sistema muestra resultados
- **Salida**: Lista de lugares filtrados

#### **4.2 Buscar Lugares por Proximidad**
- **ID**: UC-011
- **Actor**: Usuario
- **Descripci√≥n**: Encontrar lugares cercanos a una ubicaci√≥n
- **Flujo Principal**:
  1. Usuario ingresa ubicaci√≥n
  2. Sistema calcula distancias
  3. Sistema ordena por proximidad
- **Salida**: Lugares ordenados por distancia

#### **4.3 Buscar Eventos Pr√≥ximos**
- **ID**: UC-012
- **Actor**: Usuario
- **Descripci√≥n**: Eventos en los pr√≥ximos d√≠as
- **Flujo Principal**:
  1. Usuario define rango de fechas
  2. Sistema filtra eventos
  3. Sistema ordena por fecha
- **Salida**: Lista de eventos

#### **4.4 Buscar Lugares Abiertos**
- **ID**: UC-013
- **Actor**: Usuario
- **Descripci√≥n**: Lugares abiertos en un horario espec√≠fico
- **Flujo Principal**:
  1. Usuario selecciona d√≠a y horario
  2. Sistema verifica horarios
  3. Sistema filtra lugares abiertos
- **Salida**: Lugares disponibles

### **5. Gesti√≥n de Usuarios**

#### **5.1 Registro de Usuario**
- **ID**: UC-014
- **Actor**: Usuario
- **Descripci√≥n**: Crear cuenta de usuario
- **Flujo Principal**:
  1. Usuario completa formulario
  2. Sistema valida datos
  3. Sistema crea cuenta
  4. Sistema env√≠a confirmaci√≥n
- **Postcondiciones**: Usuario registrado

#### **5.2 Autenticaci√≥n**
- **ID**: UC-015
- **Actor**: Usuario
- **Descripci√≥n**: Iniciar sesi√≥n
- **Flujo Principal**:
  1. Usuario ingresa credenciales
  2. Sistema valida credenciales
  3. Sistema genera token
- **Salida**: Token de autenticaci√≥n

#### **5.3 Gestionar Roles**
- **ID**: UC-016
- **Actor**: Administrador
- **Descripci√≥n**: Asignar/cambiar roles de usuario
- **Flujo Principal**:
  1. Administrador selecciona usuario
  2. Asigna nuevo rol
  3. Sistema actualiza permisos
- **Postcondiciones**: Rol actualizado

### **6. Reportes y Analytics**

#### **6.1 Reporte de Ventas por Evento**
- **ID**: UC-017
- **Actor**: Administrador/Supervisor
- **Descripci√≥n**: Ver estad√≠sticas de ventas
- **Flujo Principal**:
  1. Usuario selecciona evento
  2. Sistema calcula estad√≠sticas
  3. Sistema genera reporte
- **Salida**: Estad√≠sticas detalladas

#### **6.2 Reporte de Lugares M√°s Populares**
- **ID**: UC-018
- **Actor**: Administrador
- **Descripci√≥n**: Lugares con m√°s eventos/ventas
- **Flujo Principal**:
  1. Usuario define per√≠odo
  2. Sistema analiza datos
  3. Sistema genera ranking
- **Salida**: Ranking de lugares

#### **6.3 Reporte de Entradas por Usuario**
- **ID**: UC-019
- **Actor**: Usuario
- **Descripci√≥n**: Historial de compras
- **Flujo Principal**:
  1. Usuario accede a su perfil
  2. Sistema carga historial
  3. Sistema muestra entradas
- **Salida**: Lista de entradas compradas

### **7. Gesti√≥n de Contenido**

#### **7.1 Subir Imagen de Lugar**
- **ID**: UC-020
- **Actor**: Administrador/Supervisor
- **Descripci√≥n**: Actualizar imagen de un lugar
- **Flujo Principal**:
  1. Usuario selecciona lugar
  2. Sube archivo de imagen
  3. Sistema procesa imagen
  4. Sistema actualiza URL
- **Postcondiciones**: Imagen actualizada

#### **7.2 Gestionar Caracter√≠sticas**
- **ID**: UC-021
- **Actor**: Administrador
- **Descripci√≥n**: Agregar/quitar caracter√≠sticas de lugares
- **Flujo Principal**:
  1. Usuario selecciona lugar
  2. Modifica caracter√≠sticas
  3. Sistema actualiza lista
- **Postcondiciones**: Caracter√≠sticas actualizadas

### **8. Notificaciones**

#### **8.1 Notificar Evento Pr√≥ximo**
- **ID**: UC-022
- **Actor**: Sistema
- **Descripci√≥n**: Recordar a usuarios sobre eventos pr√≥ximos
- **Flujo Principal**:
  1. Sistema detecta eventos pr√≥ximos
  2. Sistema identifica usuarios con entradas
  3. Sistema env√≠a notificaciones
- **Postcondiciones**: Notificaciones enviadas

#### **8.2 Notificar Cancelaci√≥n**
- **ID**: UC-023
- **Actor**: Sistema
- **Descripci√≥n**: Informar cancelaci√≥n de evento
- **Flujo Principal**:
  1. Evento es cancelado
  2. Sistema identifica usuarios afectados
  3. Sistema env√≠a notificaciones
- **Postcondiciones**: Notificaciones enviadas

---

## üèóÔ∏è Arquitectura de M√≥dulos

### **Estructura Modular Sugerida**

```
src/
‚îú‚îÄ‚îÄ cultural-places/
‚îÇ   ‚îú‚îÄ‚îÄ cultural-places.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ cultural-places.controller.ts
‚îÇ   ‚îú‚îÄ‚îÄ cultural-places.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cultural-place.schema.ts
‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ       ‚îú‚îÄ‚îÄ create-cultural-place.dto.ts
‚îÇ       ‚îî‚îÄ‚îÄ update-cultural-place.dto.ts
‚îú‚îÄ‚îÄ events/
‚îÇ   ‚îú‚îÄ‚îÄ events.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ events.controller.ts
‚îÇ   ‚îú‚îÄ‚îÄ events.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ event.schema.ts
‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ       ‚îú‚îÄ‚îÄ create-event.dto.ts
‚îÇ       ‚îî‚îÄ‚îÄ update-event.dto.ts
‚îú‚îÄ‚îÄ tickets/
‚îÇ   ‚îú‚îÄ‚îÄ tickets.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ tickets.controller.ts
‚îÇ   ‚îú‚îÄ‚îÄ tickets.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ticket.schema.ts
‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ       ‚îú‚îÄ‚îÄ create-ticket.dto.ts
‚îÇ       ‚îî‚îÄ‚îÄ use-ticket.dto.ts
‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îú‚îÄ‚îÄ users.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ users.controller.ts
‚îÇ   ‚îú‚îÄ‚îÄ users.service.ts
‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.schema.ts
‚îÇ   ‚îî‚îÄ‚îÄ dto/
‚îÇ       ‚îú‚îÄ‚îÄ create-user.dto.ts
‚îÇ       ‚îî‚îÄ‚îÄ update-user.dto.ts
‚îú‚îÄ‚îÄ reports/
‚îÇ   ‚îú‚îÄ‚îÄ reports.module.ts
‚îÇ   ‚îú‚îÄ‚îÄ reports.controller.ts
‚îÇ   ‚îî‚îÄ‚îÄ reports.service.ts
‚îî‚îÄ‚îÄ notifications/
    ‚îú‚îÄ‚îÄ notifications.module.ts
    ‚îú‚îÄ‚îÄ notifications.service.ts
    ‚îî‚îÄ‚îÄ notifications.controller.ts
```

### **Responsabilidades por M√≥dulo**

#### **CulturalPlacesModule**
- Gesti√≥n CRUD de lugares culturales
- B√∫squedas por categor√≠a y proximidad
- Validaci√≥n de datos de lugares

#### **EventsModule**
- Gesti√≥n CRUD de eventos
- Validaci√≥n de fechas y horarios
- Control de disponibilidad

#### **TicketsModule**
- Compra de entradas
- Validaci√≥n y uso de entradas
- Procesamiento de reembolsos

#### **UsersModule**
- Gesti√≥n de usuarios y roles
- Autenticaci√≥n y autorizaci√≥n
- Perfiles de usuario

#### **ReportsModule**
- Generaci√≥n de reportes
- Analytics y estad√≠sticas
- Exportaci√≥n de datos

#### **NotificationsModule**
- Env√≠o de notificaciones
- Gesti√≥n de templates
- Programaci√≥n de notificaciones

---

## üåê Endpoints Sugeridos

### **Cultural Places**
```
POST   /cultural-places              # Crear lugar
GET    /cultural-places              # Listar lugares
GET    /cultural-places/:id          # Obtener lugar
PUT    /cultural-places/:id          # Modificar lugar
DELETE /cultural-places/:id          # Desactivar lugar
GET    /cultural-places/category/:category  # Filtrar por categor√≠a
GET    /cultural-places/nearby       # Buscar por proximidad
GET    /cultural-places/open         # Lugares abiertos
```

### **Events**
```
POST   /events                       # Crear evento
GET    /events                       # Listar eventos
GET    /events/:id                   # Obtener evento
PUT    /events/:id                   # Modificar evento
DELETE /events/:id                   # Cancelar evento
GET    /events/place/:placeId        # Eventos de un lugar
GET    /events/upcoming              # Eventos pr√≥ximos
GET    /events/available             # Eventos con disponibilidad
```

### **Tickets**
```
POST   /tickets                      # Comprar entradas
GET    /tickets/user/:userId         # Entradas de usuario
PUT    /tickets/:id/use              # Usar entrada
PUT    /tickets/:id/refund           # Reembolsar entrada
GET    /tickets/event/:eventId       # Entradas de un evento
GET    /tickets/validate/:id         # Validar entrada
```

### **Users**
```
POST   /users                        # Registrar usuario
POST   /users/login                  # Autenticaci√≥n
GET    /users/profile                # Perfil de usuario
PUT    /users/profile                # Actualizar perfil
PUT    /users/:id/role               # Cambiar rol
```

### **Reports**
```
GET    /reports/sales/:eventId       # Reporte de ventas
GET    /reports/popular-places       # Lugares populares
GET    /reports/user-tickets/:userId # Entradas de usuario
GET    /reports/events/:placeId      # Eventos por lugar
```

---

## üîÑ Flujos de Trabajo

### **Flujo de Compra de Entradas**
```
1. Usuario busca evento
2. Selecciona tipos y cantidades
3. Sistema verifica disponibilidad
4. Usuario confirma compra
5. Sistema crea entradas individuales
6. Sistema actualiza contadores
7. Sistema env√≠a confirmaci√≥n
```

### **Flujo de Validaci√≥n de Entrada**
```
1. Usuario presenta entrada
2. Sistema valida entrada
3. Sistema verifica estado
4. Sistema marca como usada
5. Sistema registra uso
6. Sistema confirma validaci√≥n
```

### **Flujo de Creaci√≥n de Evento**
```
1. Usuario selecciona lugar
2. Completa datos del evento
3. Sistema valida datos
4. Sistema crea evento
5. Sistema configura tipos de entrada
6. Sistema notifica creaci√≥n
```

---

## ‚öôÔ∏è Consideraciones T√©cnicas

### **Validaciones**
- **Entrada de Datos**: Validaci√≥n con class-validator
- **Negocio**: L√≥gica de validaci√≥n en servicios
- **Base de Datos**: Constraints de Mongoose

### **Seguridad**
- **Autenticaci√≥n**: JWT tokens
- **Autorizaci√≥n**: Guards con roles
- **Validaci√≥n**: Sanitizaci√≥n de entrada

### **Performance**
- **Cach√©**: Redis para consultas frecuentes
- **√çndices**: Optimizaci√≥n de consultas MongoDB
- **Paginaci√≥n**: L√≠mites en listados

### **Escalabilidad**
- **M√≥dulos**: Separaci√≥n de responsabilidades
- **Servicios**: L√≥gica de negocio reutilizable
- **DTOs**: Transferencia de datos tipada

---

## üìù Conclusi√≥n

Este an√°lisis de casos de uso proporciona:

1. **Claridad**: Casos de uso bien definidos y documentados
2. **Completitud**: Cobertura de todas las funcionalidades principales
3. **Escalabilidad**: Estructura modular y extensible
4. **Mantenibilidad**: Separaci√≥n clara de responsabilidades
5. **Usabilidad**: Enfoque en la experiencia del usuario

Los casos de uso identificados permiten una implementaci√≥n estructurada y escalable del sistema de gesti√≥n de lugares culturales.

---

*Documento generado el: ${new Date().toLocaleDateString('es-ES')}*
*Versi√≥n: 1.0*
